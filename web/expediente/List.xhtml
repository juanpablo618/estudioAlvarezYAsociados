<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

    <ui:composition template="/template.xhtml">

        <ui:define name="body">

            <h:form style="float: right; background-color: #F4F8FA;margin-top: 1%;" class="mrgBtn">    
                <p:selectOneMenu required="true" requiredMessage="debe seleccionar un estado del tramite correcto" id="estadoDelTramite" value="#{expedienteController.estadoDelTramiteSelected}">
                    <f:selectItem itemLabel=" -- Elige un Estado del tramite --"  noSelectionOption="true"  />
                    <f:selectItems value="#{estadoDelTramiteController.items}" var="estado" itemLabel="#{estado.estado}" itemValue="#{estado.estado}" />
                </p:selectOneMenu><br></br>
                <h:commandButton class="hoverBlue" value="Filtrar por Est. del tramite" actionListener="#{expedienteController.filtrarPorEstadoDelTramite(expedienteController.getEstadoDelTramiteSelected())}"
                                 style="width: 82%; padding: 0.5%; font-family: bolt; font-weight:bold; background: #4fb2e1; border-color: #9FCBD4;color: white; border-radius: 7px 7px 7px 7px; margin-left: 10px;" />
                <h:commandButton class="hoverBlue" value="Limpiar filtros" actionListener="#{expedienteController.limpiarDosFiltros()}" onclick="PF('expedientesTable').clearFilters()" 
                                 style="width: 82%;margin-top: .5%; padding: 0.5%; font-family: bolt; font-weight:bold; background: #4fb2e1; border-color: #9FCBD4;color: white; border-radius: 7px 7px 7px 7px; margin-left: 3%;"/>
            </h:form>

            <h:form style="float: right; background-color: #F4F8FA;margin-top: 1%;" class="mrgBtn">    
                <p:inputText id="fechaDeCumple" value="#{expedienteController.fechaDeCumpleSelected}" placeholder="solo colocar día y mes = dd/MM" style="margin-left: 3%;width: 80%;" title="#{bundle.CreateExpedienteTitle_nombre}" />

                <br></br>
                <h:commandButton class="hoverBlue" value="Filtrar por Fecha de Cumpleaños" actionListener="#{expedienteController.filtrarPorFechaDeCumple(expedienteController.getFechaDeCumpleSelected())}"
                                 style="width: 82%; padding: 0.5%; font-family: bolt; font-weight:bold; background: #4fb2e1; border-color: #9FCBD4;color: white; border-radius: 7px 7px 7px 7px; margin-left: 10px;" />
                <h:commandButton class="hoverBlue" value="Limpiar filtros" onclick="PF('expedientesTable').clearFilters()" actionListener="#{expedienteController.limpiarDosFiltros()}"
                                 style="width: 82%;margin-top: .5%; padding: 0.5%; font-family: bolt; font-weight:bold; background: #4fb2e1; border-color: #9FCBD4;color: white; border-radius: 7px 7px 7px 7px; margin-left: 3%;"/>
            </h:form>

            
            <h:form id="ExpedienteListForm" style=" background-color: #F4F8FA;">

                <div style="width: 100%"> 
                    <p:splitButton value="CREAR EXPEDIENTE" class="btmMarginLeft" style="border-bottom-left-radius: 20px;border-top-left-radius: 20px;border-bottom-right-radius: 0px;border-top-right-radius: 0px; padding: 2%; color: white; font-family: gotham Logo; " >
                        <p:menuitem class="subMenu" style="background-color: #38978c !important; " value="Administrativo " actionListener="#{expedienteController.prepareCreateExpAdministrativo()}" update=":ExpedienteCreateForm" oncomplete="PF('ExpedienteCreateDialog').show()"  />
                        <p:separator />
                        <p:menuitem class="subMenu" style="background-color: #38978c !important" value="Judicial " actionListener="#{expedienteController.prepareCreateExpJudicial()}" update=":ExpedienteJudicialCreateForm" oncomplete="PF('ExpedienteJudicialCreateDialog').show()" />
                        <p:separator />
                        <p:menuitem class="subMenu" style="background-color: #38978c !important" value="Sin carpeta " actionListener="#{expedienteController.prepareCreateExpSinCarpeta()}" update=":ExpedienteSinCarpetaCreateForm" oncomplete="PF('ExpedienteSinCarpetaCreateDialog').show()" />
                    </p:splitButton>


                    <h:commandLink style="float: right;margin-top: 1%;margin-right: 1%;">
                        <h:graphicImage value="../faces/resources/images/pdficon2.png" width="50px" title="Descargar Solo Filtrados" />
                        <p:dataExporter type="pdf" target="datalist" fileName="expedientesFiltrados" pageOnly="true" />
                    </h:commandLink>
                    <h:commandLink style="float: right;margin-top: 1%;" >
                        <h:graphicImage value="../faces/resources/images/pdficon.png" width="50px" title="Descargar Todo"/>
                        <p:dataExporter type="pdf" target="datalist" fileName="todosLosExpedientes" pageOnly="false" />
                    </h:commandLink>

                </div>
                <br></br>

                <p:dataTable id="datalist" value="#{expedienteController.items}" var="item"
                             selectionMode="single" selection="#{expedienteController.selected}"
                             paginator="true"
                             rowKey="#{item.idExpediente}"
                             widgetVar="expedientesTable"
                             rows="50"
                             rowsPerPageTemplate="50,60,70,80,90"
                             filteredValue="#{expedienteController.filteredExpedientes}"
                             resizableColumns="true"
                             rendered="true"  
                             emptyMessage="no existen expedientes con ese filtro"
                             >

                    <p:ajax event="rowSelect"   update="createButton "/>
                    <p:ajax event="rowUnselect" update="createButton "/>

                    <p:growl  id="message" showDetail="true" />

                    <p:column style="width: 8% !important;" filterBy="#{item.orden}" sortBy="#{item.orden}" styleClass="centeredColumnContent#{item.getTipoDeExpedienteParaEstilo()}" filterMatchMode="exact">
                        <f:facet name="header">
                            <h:outputText value="#{bundle.ListExpedienteTitle_orden}"/>
                        </f:facet>
                        <center>
                            <h:outputText value="#{item.orden}"/>
                        </center>
                    </p:column>

                    <p:column style="width: 35% !important;" filterBy="#{item.apellidoYNombre}" filterFunction="#{expedienteController.filterByApellidoYNombre}"  styleClass="centeredColumnContent#{item.getTipoDeExpedienteParaEstilo()}" filterMatchMode="contains">
                        <f:facet name="header" >
                            <h:outputText  value="APELLIDO Y NOMBRE"/>
                        </f:facet>
                        <center>
                            <h:outputText  id="JuanCuello" value="#{ item.apellidoYNombre}"/>
                        </center>
                    </p:column>

                    <p:column style="width: 11% !important;" filterBy="#{item.getCuitRecordado()}" sortBy="#{item.getCuitRecordado()}" styleClass="centeredColumnContent#{item.getTipoDeExpedienteParaEstilo()}" filterMatchMode="contains">
                        <f:facet name="header">
                            <h:outputText value="DNI"/>
                        </f:facet>
                        <center>
                            <h:outputText value="#{item.getCuitRecordado()}"/>
                        </center>
                    </p:column>

                    <p:column style="width: 15% !important;text-align: center; " styleClass="centeredColumnContent#{item.getTipoDeExpedienteParaEstilo()}" exportable="false">

                        <f:facet name="header">
                            <h:outputText value="ACCIONES"/>
                        </f:facet>

                        <p:commandButton class="linea btnKey"  update=":ExpedienteViewDocumentosForm" rendered="#{item.tipoDeExpediente eq 'judicial' or item.tipoDeExpediente eq 'administrativo'}" oncomplete="PF('ExpedienteViewDocumentosDialog').show()" icon="ui-icon-folder-open" title="Documentos">
                            <f:setPropertyActionListener value="#{item}" target="#{expedienteController.selected}" />
                        </p:commandButton>
                        
                        <p:commandButton class="linea btnKey"  update=":ExpedienteViewClavesForm2" oncomplete="PF('ExpedienteViewClavesDialog2').show()" icon="ui-icon-locked" title="Claves">
                            <f:setPropertyActionListener value="#{item}" target="#{expedienteController.selected}" />
                        </p:commandButton>

                        <p:commandButton class="linea btnSearch"  update=":ExpedienteEditForm" oncomplete="PF('ExpedienteEditDialog').show()"  icon="ui-icon-search" rendered="#{item.tipoDeExpediente eq 'administrativo'}" title="Ver exp. Administrativo">
                            <f:setPropertyActionListener value="#{item}" target="#{expedienteController.selected}" />
                        </p:commandButton>

                        <p:commandButton class="linea btnSearch"  update=":ExpedienteSinCarpetaEditForm" oncomplete="PF('ExpedienteSinCarpetaEditDialog').show()"  icon="ui-icon-search" rendered="#{item.tipoDeExpediente eq 'sin carpeta'}" title="Ver exp. Sin Carpeta">
                            <f:setPropertyActionListener value="#{item}" target="#{expedienteController.selected}" />
                        </p:commandButton>

                        <p:commandButton class="linea btnSearch"  update=":ExpedienteJudicialEditForm" oncomplete="PF('ExpedienteJudicialEditDialog').show()" rendered="#{item.tipoDeExpediente eq 'judicial'}" icon="ui-icon-search" title="Ver exp. Judicial">
                            <f:setPropertyActionListener value="#{item}" target="#{expedienteController.selected}" />
                        </p:commandButton>

                        <p:commandButton class="linea btnDelete" update=":growl,datalist, message" oncomplete="PF('expedientesTable').clearFilters()" actionListener="#{expedienteController.destroy}"  icon="ui-icon-trash" title="Eliminar">
                            <f:setPropertyActionListener value="#{item}" target="#{expedienteController.selected}" />
                            <p:confirm header="Confirmación" message="¿Estas seguro?"  icon="ui-icon-alert"/>
                        </p:commandButton>

                        <p:confirmDialog  global="true" showEffect="fade" hideEffect="fade">
                            <p:commandButton update=":ExpedienteListForm" value="Si" type="button" styleClass="ui-confirmdialog-yes ui-state-default" icon="ui-icon-check" style="color: black;" />
                            <p:commandButton update=":ExpedienteListForm" value="No" type="button" styleClass="ui-confirmdialog-no ui-state-error-text" icon="ui-icon-close" style="color: black;" />
                        </p:confirmDialog> 

                    </p:column>

                    <f:facet name="footer">
                        <p:commandButton id="createButton" rendered="false" icon="ui-icon-plus"   value="#{bundle.Create}" actionListener="#{expedienteController.prepareCreate}" update=":ExpedienteCreateForm" oncomplete="PF('ExpedienteCreateDialog').show()"/>
                    </f:facet>
                </p:dataTable>
                <p:contextMenu for="datalist">
                    <p:menuitem icon="ui-icon-pencil" style="background-color: white !important" value="agregar Agenda" actionListener="#{agendaController.prepareCreate}" update=":ExpedienteViewFormParaAgenda" oncomplete="PF('ExpedienteViewDialogParaAgenda').show()" />             

                    <p:menuitem icon="ui-icon-pencil" style="background-color: white !important" value="agregar Turno" actionListener="#{turnoController.prepareCreate}" update=":ExpedienteViewFormParaTurno" oncomplete="PF('ExpedienteViewDialogParaTurno').show()" />             

                </p:contextMenu>    
                
            </h:form>

            <ui:include src="Create.xhtml"/>
            <ui:include src="CreateExpJudicial.xhtml"/>
            <ui:include src="CreateExpSinCarpeta.xhtml"/>
            <ui:include src="Edit.xhtml"/>
            <ui:include src="EditExpSinCarpeta.xhtml"/>
            <ui:include src="EditExpJudicial.xhtml"/>
            <ui:include src="ViewParaAgenda.xhtml"/>
            <ui:include src="View_1.xhtml"/>
            <ui:include src="ViewDocumentos.xhtml"/>
            
            <ui:include src="ViewExpJudicial.xhtml"/>
            <ui:include src="ViewParaTurno.xhtml"/>
        </ui:define>
    </ui:composition>

</html>